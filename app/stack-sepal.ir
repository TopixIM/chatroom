{:package "chatroom", :definitions {"comp.room/style-title" ["def" "style-title" ["{}" [":font-family" "|Josefin Sans"] [":font-weight" "300"] [":font-size" "20"] [":color" "colors/texture-light"]]], "comp.header/style-cursor" ["def" "style-cursor" ["{}" [":cursor" "|pointer"]]], "comp.message/style-author" ["def" "style-author" ["{}" [":display" ":inline-block"] [":font-size" "12"] [":background-color" ["hsl" "260" "60" "92"]] [":color" ":white"] [":padding" "|0 8px"] [":line-height" "|16px"]]], "comp.topic/style-topic" ["def" "style-topic" ["{}" [":cursor" ":pointer"] [":font-size" "16"]]], "comp.header/on-profile" ["defn" "on-profile" ["e" "dispatch!"] ["dispatch!" ":router/change" ["{}" [":name" ":profile"] [":data" "nil"] [":router" "nil"]]]], "comp.login/update-state" ["defn" "update-state" ["state" "k" "v"] ["assoc" "state" "k" "v"]], "comp.message/render" ["defn" "render" ["message"] ["fn" ["state" "mutate!"] ["let" [["author" [":author" "message"]]] ["div" ["{}"] ["div" ["{}" [":style" "style-author"] [":attrs" ["{}" [":inner-text" [":name" "author"]]]]]] ["comp-space" "8" "nil"] ["comp-text" [":text" "message"] "nil"] ["--" "comp-debug" [":author" "message"] "nil"]]]]], "comp.topics/style-header" ["def" "style-header" ["{}" [":font-family" "|Josefin Sans"] [":font-size" "24"] [":font-weight" ":lighter"]]], "core/on-jsload" ["defn" "on-jsload" [] ["clear-cache!"] ["render-app!"] ["println" "|code updated."]], "core/-main" ["defn" "-main" [] ["enable-console-print!"] ["render-app!"] ["setup-socket!" "store-ref" ["{}" [":url" ["str" "|ws://" [".-hostname" "js/location"] "|:5021"]] [":on-close!" ["fn" ["event"] [".error" "js/console" "|Lost connection!"]]]]] ["add-watch" "store-ref" ":changes" "render-app!"] ["add-watch" "states-ref" ":changes" "render-app!"] ["println" "|app started!"]], "comp.topics/init-state" ["defn" "init-state" ["&" "args"] "|"], "core/store-ref" ["defonce" "store-ref" ["atom" ["{}"]]], "comp.topics/comp-topics" ["def" "comp-topics" ["create-comp" ":topics" "init-state" "update-state" "render"]], "comp.login/on-toggle" ["defn" "on-toggle" ["mutate!" "signup?"] ["fn" ["e" "dispatch!"] ["mutate!" ":signup?" ["not" "signup?"]]]], "comp.message/comp-message" ["def" "comp-message" ["create-comp" ":message" "render"]], "comp.room/on-send" ["defn" "on-send" ["mutate!" "topic-id" "text"] ["fn" ["e" "dispatch!"] ["dispatch!" ":message/create" ["[]" "topic-id" "text"]] ["mutate!" "|"]]], "comp.topic/comp-topic" ["def" "comp-topic" ["create-comp" ":topic" "render"]], "comp.topic/render" ["defn" "render" ["topic"] ["fn" ["state" "mutate!"] ["let" [["author" [":author" "topic"]]] ["div" ["{}" [":style" "style-topic"] [":event" ["{}" [":click" ["on-topic" [":id" "topic"] [":title" "topic"]]]]]] ["--" "comp-debug" [":author" "topic"] "nil"] ["div" ["{}" [":style" "style-name"] [":attrs" ["{}" [":inner-text" [":name" "author"]]]]]] ["comp-space" "8" "nil"] ["comp-text" [":title" "topic"] "nil"]]]]], "comp.room/comp-room" ["def" "comp-room" ["create-comp" ":room" "init-state" "update-state" "render"]], "comp.room/on-keydown" ["defn" "on-keydown" ["mutate!" "topic-id" "text"] ["fn" ["e" "dispatch!"] ["if" ["and" ["=" [":key-code" "e"] "13"] ["not" ["string/blank?" "text"]]] ["do" ["dispatch!" ":message/create" ["[]" "topic-id" "text"]] ["mutate!" "|"]]]]], "comp.login/on-submit" ["defn" "on-submit" ["username" "password" "signup?"] ["fn" ["e" "dispatch!"] ["dispatch!" ["if" "signup?" ":user/sign-up" ":user/log-in"] ["[]" "username" "password"]]]], "comp.container/render" ["defn" "render" ["store"] ["fn" ["state" "mutate!"] ["let" [["router" ["get-in" "store" ["[]" ":state" ":router"]]]] ["div" ["{}" [":style" ["merge" "ui/global" "ui/fullscreen" "ui/column"]]] ["comp-header" [":logged-in?" "store"]] ["div" ["{}" [":style" "style-body"]] ["if" [":logged-in?" "store"] ["case" [":name" "router"] [":home" ["comp-topics" [":data" "store"] [":logged-in?" "store"]]] [":topic" ["comp-room" [":data" "store"] [":data" "router"] [":title" "router"]]] [":profile" ["comp-profile" "store"]] "nil"] ["comp-login"]]] ["comp-debug" "router" ["{}" [":bottom" "0"] [":left" "0"] [":max-width" "|100%"]]] ["comp-msg-list" ["get-in" "store" ["[]" ":state" ":notifications"]] ":state/remove-notification"]]]]], "comp.login/init-state" ["defn" "init-state" ["&" "args"] ["{}" [":signup?" "false"] [":username" "|"] [":password" "|"]]], "core/dispatch!" ["defn" "dispatch!" ["op" "op-data"] ["send!" "op" "op-data"]], "comp.topic/style-name" ["def" "style-name" ["{}" [":display" ":inline-block"] [":font-size" "12"] [":background-color" ["hsl" "260" "60" "88"]] [":color" ":white"] [":padding" "|0 8px"] [":line-height" "|16px"]]], "comp.room/init-state" ["defn" "init-state" ["&" "args"] "|"], "network/receiver" ["defonce" "receiver" ["chan"]], "comp.login/on-input" ["defn" "on-input" ["mutate!" "k"] ["fn" ["e" "dispatch!"] ["mutate!" "k" [":value" "e"]]]], "comp.container/comp-container" ["def" "comp-container" ["create-comp" ":container" "render"]], "comp.topic/on-topic" ["defn" "on-topic" ["topic-id" "topic-title"] ["fn" ["e" "dispatch!"] ["dispatch!" ":router/change" ["{}" [":name" ":topic"] [":title" ["str" "topic-title"]] [":data" "topic-id"] [":router" "nil"]]]]], "comp.login/render" ["defn" "render" [] ["fn" ["state" "mutate!"] ["div" ["{}" [":style" ["merge" "ui/flex" "ui/column"]]] ["div" ["{}"] ["comp-text" ["if" [":signup?" "state"] "|Sign up" "|Log in"] [":style" "style-title"]] ["if" [":signup?" "state"] ["div" ["{}"] ["comp-text" "|Want to log in?" "nil"] ["comp-space" "8" "nil"] ["div" ["{}" [":style" "ui/clickable-text"] [":event" ["{}" [":click" ["on-toggle" "mutate!" [":signup?" "state"]]]]]] ["comp-text" "|Log in" "nil"]]] ["div" ["{}"] ["comp-text" "|No account yet?" "nil"] ["comp-space" "8" "nil"] ["div" ["{}" [":style" "ui/clickable-text"] [":event" ["{}" [":click" ["on-toggle" "mutate!" [":signup?" "state"]]]]]] ["comp-text" "|Sign up" "nil"]]]]] ["div" ["{}" [":style" ["{}"]]] ["div" ["{}"] ["input" ["{}" [":style" "ui/input"] [":attrs" ["{}" [":placeholder" "|Username"] [":value" [":username" "state"]]]] [":event" ["{}" [":input" ["on-input" "mutate!" ":username"]]]]]]] ["comp-space" "nil" "8"] ["div" ["{}"] ["input" ["{}" [":style" "ui/input"] [":attrs" ["{}" [":placeholder" "|Password"] [":value" [":password" "state"]]]] [":event" ["{}" [":input" ["on-input" "mutate!" ":password"]]]]]]]] ["comp-space" "nil" "8"] ["div" ["{}" [":style" "ui/flex"]] ["button" ["{}" [":style" ["merge" "ui/button" ["{}" [":outline" ":none"] [":border" ":none"]]]] [":event" ["{}" [":click" ["on-submit" [":username" "state"] [":password" "state"] [":signup?" "state"]]]]]] ["comp-text" "|Submit" "nil"]]] ["--" "comp-debug" "state" "nil"]]]], "core/states-ref" ["defonce" "states-ref" ["atom" ["{}"]]], "comp.header/render" ["defn" "render" ["logged-in?"] ["fn" ["state" "mutate!"] ["div" ["{}" [":style" ["merge" "ui/row-center" "style-header"]]] ["div" ["{}" [":event" ["{}" [":click" "on-home"]]] [":style" "style-cursor"]] ["comp-text" "|Chat" "nil"]] ["div" ["{}" [":style" "style-cursor"] [":event" ["{}" [":click" "on-profile"]]]] ["comp-text" ["if" "logged-in?" "|Me" "|Guest"] "nil"]]]]], "comp.topics/on-input" ["defn" "on-input" ["mutate!"] ["fn" ["e" "dispatch!"] ["mutate!" [":value" "e"]]]], "comp.profile/on-log-out" ["defn" "on-log-out" ["e" "dispatch!"] ["dispatch!" ":user/log-out" "nil"]], "comp.header/comp-header" ["def" "comp-header" ["create-comp" ":header" "render"]], "network/sender" ["defonce" "sender" ["chan"]], "comp.container/style-body" ["def" "style-body" ["{}" [":padding" "|16px 32px"]]], "comp.header/style-header" ["def" "style-header" ["{}" [":height" "48"] [":background-color" "colors/motif"] [":justify-content" ":space-between"] [":padding" "|0 16px"] [":font-size" "20"] [":font-weight" "300"] [":font-family" "|Josefin Sans"] [":color" ":white"]]], "comp.topics/update-state" ["defn" "update-state" ["state" "text"] "text"], "comp.login/comp-login" ["def" "comp-login" ["create-comp" ":login" "init-state" "update-state" "render"]], "comp.room/update-state" ["defn" "update-state" ["state" "text"] "text"], "comp.header/on-home" ["defn" "on-home" ["e" "dispatch!"] ["dispatch!" ":router/change" ["{}" [":name" ":home"] [":data" "nil"] [":router" "nil"]]]], "comp.room/render" ["defn" "render" ["messages" "topic-id" "title"] ["fn" ["state" "mutate!"] ["div" ["{}" [":style" ["merge" "ui/column" "ui/flex"]]] ["div" ["{}" [":style" "style-title"]] ["comp-text" "title" "nil"]] ["div" ["{}" [":style" "ui/flex"]] ["->>" ["vals" "messages"] ["map" ["fn" ["message"] ["[]" [":id" "message"] ["comp-message" "message"]]]]]] ["div" ["{}" [":style" "ui/row"]] ["input" ["{}" [":style" ["merge" "ui/input" "ui/flex"]] [":attrs" ["{}" [":placeholder" "|reply here..."] [":value" "state"]]] [":event" ["{}" [":input" ["on-input" "mutate!"]] [":keydown" ["on-keydown" "mutate!" "topic-id" "state"]]]]]] ["comp-space" "8" "nil"] ["button" ["{}" [":style" "ui/button"] [":event" ["{}" [":click" ["on-send" "mutate!" "topic-id" "state"]]]]] ["comp-text" "|Send" "nil"]]]]]], "comp.topics/on-add" ["defn" "on-add" ["mutate!" "text"] ["fn" ["e" "dispatch!"] ["dispatch!" ":topic/create" "text"] ["mutate!" "|"]]], "comp.room/on-input" ["defn" "on-input" ["mutate!"] ["fn" ["e" "dispatch!"] ["mutate!" [":value" "e"]]]], "comp.profile/comp-profile" ["def" "comp-profile" ["create-comp" ":profile" "render"]], "comp.profile/style-trigger" ["def" "style-trigger" ["{}" [":font-size" "14"] [":cursor" ":pointer"] [":background-color" "colors/motif-light"] [":color" ":white"] [":padding" "|0 8px"]]], "comp.profile/render" ["defn" "render" ["store"] ["fn" ["state" "mutate!"] ["div" ["{}" [":style" "ui/flex"]] ["comp-text" ["str" "|Hello! " ["get-in" "store" ["[]" ":user" ":name"]]] "nil"] ["comp-space" "8" "nil"] ["a" ["{}" [":style" "style-trigger"] [":event" ["{}" [":click" "on-log-out"]]]] ["comp-text" "|Log out" "nil"]]]]], "network/send!" ["defn" "send!" ["op" "op-data"] ["go" [">!" "sender" ["[]" "op" "op-data"]]]], "comp.topics/render" ["defn" "render" ["topics" "logged-in?"] ["fn" ["state" "mutate!"] ["div" ["{}" [":style" ["merge" "ui/flex"]]] ["div" ["{}" [":style" "style-header"]] ["comp-text" "|Topics" "nil"]] ["if" "logged-in?" ["div" ["{}" [":style" "ui/row"]] ["input" ["{}" [":style" ["merge" "ui/flex" "ui/input"]] [":attrs" ["{}" [":placeholder" "|Some topic..."] [":value" "state"]]] [":event" ["{}" [":input" ["on-input" "mutate!"]]]]]] ["comp-space" "8" "nil"] ["button" ["{}" [":style" "ui/button"] [":event" ["{}" [":click" ["on-add" "mutate!" "state"]]]]] ["comp-text" "|Add" "nil"]]]] ["div" ["{}"] ["->>" ["vals" "topics"] ["map" ["fn" ["topic"] ["[]" [":id" "topic"] ["comp-topic" "topic"]]]]]]]]], "network/setup-socket!" ["defn" "setup-socket!" ["store-ref" "configs"] ["let" [["ws-url" [":url" "configs"]] ["ws" ["js/WebSocket." "ws-url"]] ["handle-close!" ["if" ["fn?" [":on-close!" "configs"]] [":on-close!" "configs"] "identity"]] ["handle-open!" ["if" ["fn?" [":on-open!" "configs"]] [":on-open!" "configs"] "identity"]]] ["set!" "ws.onopen" ["fn" ["event"] ["handle-open!" "event"]]] ["set!" "ws.onclose" ["fn" ["event"] ["handle-close!" "event"]]] ["set!" "ws.onmessage" ["fn" ["event"] ["let" [["changes" ["reader/read-string" "event.data"]]] ["println" "|Changes" "changes"] ["reset!" "store-ref" ["patch-bunch" "@store-ref" "changes"]]]]] ["go" ["loop" ["[]"] [".send" "ws" ["pr-str" ["<!" "sender"]]] ["recur"]]]]], "comp.login/style-title" ["def" "style-title" ["{}" [":font-size" "24"] [":font-weight" "300"] [":font-family" "|Josefin Sans"]]], "core/render-app!" ["defn" "render-app!" [] ["let" [["target" [".querySelector" "js/document" "|#app"]]] ["render!" ["comp-container" "@store-ref"] "target" "dispatch!" "states-ref"]]]}, :namespaces {"comp.profile" ["ns" "chatroom.comp.profile" [":require" ["[]" "hsl.core" ":refer" ["[]" "hsl"]] ["[]" "respo-ui.style" ":as" "ui"] ["[]" "respo-ui.style.colors" ":as" "colors"] ["[]" "respo.alias" ":refer" ["[]" "create-comp" "div" "span" "a"]] ["[]" "respo.comp.debug" ":refer" ["[]" "comp-debug"]] ["[]" "respo.comp.text" ":refer" ["[]" "comp-code" "comp-text"]] ["[]" "respo.comp.space" ":refer" ["[]" "comp-space"]]]], "comp.room" ["ns" "chatroom.comp.room" [":require" ["[]" "hsl.core" ":refer" ["[]" "hsl"]] ["[]" "clojure.string" ":as" "string"] ["[]" "respo-ui.style" ":as" "ui"] ["[]" "respo-ui.style.colors" ":as" "colors"] ["[]" "respo.alias" ":refer" ["[]" "create-comp" "div" "span" "input" "button"]] ["[]" "respo.comp.debug" ":refer" ["[]" "comp-debug"]] ["[]" "respo.comp.text" ":refer" ["[]" "comp-code" "comp-text"]] ["[]" "respo.comp.space" ":refer" ["[]" "comp-space"]] ["[]" "chatroom.comp.message" ":refer" ["[]" "comp-message"]]]], "comp.container" ["ns" "chatroom.comp.container" [":require" ["[]" "hsl.core" ":refer" ["[]" "hsl"]] ["[]" "respo-ui.style" ":as" "ui"] ["[]" "respo-ui.style.colors" ":as" "colors"] ["[]" "respo.alias" ":refer" ["[]" "create-comp" "div" "span"]] ["[]" "respo.comp.debug" ":refer" ["[]" "comp-debug"]] ["[]" "respo.comp.text" ":refer" ["[]" "comp-code" "comp-text"]] ["[]" "chatroom.comp.header" ":refer" ["[]" "comp-header"]] ["[]" "chatroom.comp.profile" ":refer" ["[]" "comp-profile"]] ["[]" "chatroom.comp.topics" ":refer" ["[]" "comp-topics"]] ["[]" "chatroom.comp.room" ":refer" ["[]" "comp-room"]] ["[]" "chatroom.comp.login" ":refer" ["[]" "comp-login"]] ["[]" "respo-message.comp.msg-list" ":refer" ["[]" "comp-msg-list"]]]], "network" ["ns" "chatroom.network" [":require-macros" ["[]" "cljs.core.async.macros" ":refer" ["[]" "go"]]] [":require" ["[]" "cljs.reader" ":as" "reader"] ["[]" "cljs.core.async" ":as" "a" ":refer" ["[]" ">!" "<!" "chan" "timeout"]] ["[]" "recollect.patch" ":refer" ["[]" "patch-bunch"]]]], "comp.login" ["ns" "chatroom.comp.login" [":require" ["[]" "respo.alias" ":refer" ["[]" "create-comp" "div" "input" "button"]] ["[]" "respo.comp.text" ":refer" ["[]" "comp-text"]] ["[]" "respo.comp.space" ":refer" ["[]" "comp-space"]] ["[]" "respo.comp.debug" ":refer" ["[]" "comp-debug"]] ["[]" "respo-ui.style" ":as" "ui"]]], "comp.topics" ["ns" "chatroom.comp.topics" [":require" ["[]" "respo.alias" ":refer" ["[]" "create-comp" "div" "span" "input" "button"]] ["[]" "respo.comp.text" ":refer" ["[]" "comp-text"]] ["[]" "respo.comp.space" ":refer" ["[]" "comp-space"]] ["[]" "respo-ui.style" ":as" "ui"] ["[]" "respo-ui.style.colors" ":as" "colors"] ["[]" "chatroom.comp.topic" ":refer" ["[]" "comp-topic"]]]], "comp.message" ["ns" "chatroom.comp.message" [":require" ["[]" "hsl.core" ":refer" ["[]" "hsl"]] ["[]" "respo.alias" ":refer" ["[]" "create-comp" "div" "span" "input" "button"]] ["[]" "respo.comp.text" ":refer" ["[]" "comp-text"]] ["[]" "respo.comp.space" ":refer" ["[]" "comp-space"]] ["[]" "respo.comp.debug" ":refer" ["[]" "comp-debug"]] ["[]" "respo-ui.style" ":as" "ui"] ["[]" "respo-ui.style.colors" ":as" "colors"]]], "comp.topic" ["ns" "chatroom.comp.topic" [":require" ["[]" "hsl.core" ":refer" ["[]" "hsl"]] ["[]" "respo.alias" ":refer" ["[]" "create-comp" "div" "span" "input" "button"]] ["[]" "respo.comp.text" ":refer" ["[]" "comp-text"]] ["[]" "respo.comp.space" ":refer" ["[]" "comp-space"]] ["[]" "respo.comp.debug" ":refer" ["[]" "comp-debug"]] ["[]" "respo-ui.style" ":as" "ui"] ["[]" "respo-ui.style.colors" ":as" "colors"]]], "comp.header" ["ns" "chatroom.comp.header" [":require" ["[]" "hsl.core" ":refer" ["[]" "hsl"]] ["[]" "respo-ui.style" ":as" "ui"] ["[]" "respo-ui.style.colors" ":as" "colors"] ["[]" "respo.alias" ":refer" ["[]" "create-comp" "div" "span"]] ["[]" "respo.comp.debug" ":refer" ["[]" "comp-debug"]] ["[]" "respo.comp.text" ":refer" ["[]" "comp-code" "comp-text"]]]], "core" ["ns" "chatroom.core" [":require" ["[]" "respo.core" ":refer" ["[]" "render!" "clear-cache!"]] ["[]" "chatroom.comp.container" ":refer" ["[]" "comp-container"]] ["[]" "cljs.reader" ":refer" ["[]" "read-string"]] ["[]" "chatroom.network" ":refer" ["[]" "send!" "setup-socket!"]]]]}, :procedures {"style.typeset" [], "comp.profile" [], "comp.room" [], "style.devtool" [], "comp.container" [], "network" [], "comp.login" [], "comp.topics" [], "comp.message" [], "comp.home" [], "comp.topic" [], "comp.header" [], "core" [["set!" "js/window.onload" "-main"]], "style.layout" [], "style.widget" []}}